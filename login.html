<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login | Nanny Driver</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      /* Tailwind classes will handle background and centering */
    }
    /* Custom styles can still be added if Tailwind doesn't cover everything */
    .login-container {
      background-color: white;
      padding: 40px; /* p-10 in Tailwind */
      border-radius: 12px; /* rounded-xl in Tailwind */
      box-shadow: 0 0 12px rgba(0, 0, 0, 0.05); /* shadow-lg in Tailwind */
      max-width: 400px; /* max-w-md in Tailwind */
      width: 100%; /* w-full in Tailwind */
    }

    h2 {
      text-align: center; /* text-center in Tailwind */
      margin-bottom: 30px; /* mb-8 in Tailwind */
      color: #4B0082; /* You can define this as a custom color in tailwind.config.js or use inline style */
    }

    input[type="email"],
    input[type="password"] {
      padding: 12px; /* p-3 in Tailwind */
      margin-bottom: 20px; /* mb-5 in Tailwind */
      border: 1px solid #ccc; /* border border-gray-300 in Tailwind */
      border-radius: 6px; /* rounded-md in Tailwind */
      font-size: 1rem; /* text-base in Tailwind */
    }

    .forgot-password {
      text-align: right; /* text-right in Tailwind */
      font-size: 0.9rem; /* text-sm in Tailwind */
      margin-bottom: 20px; /* mb-5 in Tailwind */
    }

    .forgot-password a {
      color: #7D30B6;
      text-decoration: none; /* no-underline in Tailwind */
    }

    .forgot-password a:hover {
      text-decoration: underline; /* hover:underline in Tailwind */
    }

    button[type="submit"] {
      background-color: #7D30B6;
      color: white; /* text-white in Tailwind */
      padding: 12px; /* p-3 in Tailwind */
      border: none; /* border-none in Tailwind */
      border-radius: 6px; /* rounded-md in Tailwind */
      font-size: 1rem; /* text-base in Tailwind */
      font-weight: 600; /* font-semibold in Tailwind */
      cursor: pointer; /* cursor-pointer in Tailwind */
    }

    button[type="submit"]:hover {
      background-color: #68249c;
    }

    .signup-link {
      text-align: center; /* text-center in Tailwind */
      margin-top: 20px; /* mt-5 in Tailwind */
      font-size: 0.95rem; /* text-sm in Tailwind (approx) */
    }

    .signup-link a {
      color: #7D30B6;
      text-decoration: none; /* no-underline in Tailwind */
      font-weight: 500; /* font-medium in Tailwind */
    }

    .signup-link a:hover {
      text-decoration: underline; /* hover:underline in Tailwind */
    }

    /* Message area styles */
    #message-area {
      margin-top: 15px;
      padding: 10px;
      border-radius: 6px;
      font-size: 0.9rem;
      text-align: center;
    }
    #message-area.success {
      background-color: #e6fffa; /* Tailwind: bg-green-50 */
      color: #38a169; /* Tailwind: text-green-700 */
      border: 1px solid #a0f0d0; /* Tailwind: border-green-300 */
    }
    #message-area.error {
      background-color: #fff5f5; /* Tailwind: bg-red-50 */
      color: #c53030; /* Tailwind: text-red-700 */
      border: 1px solid #fc8181; /* Tailwind: border-red-300 */
    }
  </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-6">

  <div class="login-container bg-white p-10 rounded-xl shadow-lg max-w-md w-full">
    <h2 class="text-2xl font-bold text-center mb-8" style="color: #4B0082;">Welcome Back</h2>
    <form id="loginForm">
      <input type="email" id="email" placeholder="Email Address" required class="w-full p-3 mb-5 border border-gray-300 rounded-md text-base" />
      <input type="password" id="password" placeholder="Password" required class="w-full p-3 mb-5 border border-gray-300 rounded-md text-base" />
      <div class="forgot-password text-right text-sm mb-5">
        <a href="#" id="forgot-password-link" class="no-underline hover:underline" style="color: #7D30B6;">Forgot password?</a>
      </div>
      <button type="submit" class="w-full text-white p-3 border-none rounded-md text-base font-semibold cursor-pointer hover:bg-purple-700" style="background-color: #7D30B6;">Log In</button>
    </form>
    <div id="message-area" class="hidden"></div>
    <div class="signup-link text-center mt-5 text-sm">
      New to Nanny Driver? <a href="signup.html" class="no-underline hover:underline font-medium" style="color: #7D30B6;">Create an account</a>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-auth-compat.js"></script>

  <script>
    // IMPORTANT: Please verify these details with your Firebase project settings!
    // This configuration uses the second set of values you provided.
    const firebaseConfig = {
      apiKey: "AIzaSyCJXD8-sk0kZ_v5ExcshtrH0eYeIMTmF8U", // From your second config
      authDomain: "nannydriver-ac620.firebaseapp.com",
      projectId: "nannydriver-ac620",
      storageBucket: "nannydriver-ac620.firebasestorage.app", // From your second config
      messagingSenderId: "303049608672", // From your second config
      appId: "1:303049608672:web:6964a167f41b55a29fef85", // App ID from second config (check if this is correct)
      measurementId: "G-39XNL9VQTN"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth(); // Get the auth instance

    const loginForm = document.getElementById("loginForm");
    const emailInput = document.getElementById("email");
    const passwordInput = document.getElementById("password");
    const forgotPasswordLink = document.getElementById("forgot-password-link");
    const messageArea = document.getElementById("message-area");

    function showMessage(text, type = "error") {
      messageArea.textContent = text;
      messageArea.className = type; // 'error' or 'success'
      messageArea.classList.remove('hidden'); // Make it visible
    }

    loginForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const email = emailInput.value;
      const password = passwordInput.value;
      messageArea.classList.add('hidden'); // Hide previous messages

      auth.signInWithEmailAndPassword(email, password)
        .then((userCredential) => {
          showMessage("Login successful!", "success");
          // Redirect to homepage or dashboard
          // For testing, you might want to delay this to see the message
          setTimeout(() => {
             window.location.href = "index.html";
          }, 1500);
        })
        .catch((error) => {
          let message;
          switch (error.code) {
            case "auth/user-not-found":
              message = "No account found with this email.";
              break;
            case "auth/wrong-password":
              message = "Incorrect password. Please try again.";
              break;
            case "auth/invalid-email":
              message = "Please enter a valid email address.";
              break;
            case "auth/invalid-credential":
                 message = "Incorrect email or password. Please try again."; // More generic for invalid credentials
                 break;
            default:
              console.error("Firebase login error:", error); // Log the full error for debugging
              message = "Login failed: " + error.message;
          }
          showMessage(message, "error");
        });
    });

    forgotPasswordLink.addEventListener("click", (e) => {
      e.preventDefault();
      const email = emailInput.value;
      messageArea.classList.add('hidden'); // Hide previous messages

      if (!email) {
        showMessage("Please enter your email address first to reset password.", "error");
        return;
      }

      auth.sendPasswordResetEmail(email)
        .then(() => {
          showMessage("Password reset email sent. Please check your inbox.", "success");
        })
        .catch((error) => {
          let message;
          switch (error.code) {
            case "auth/user-not-found":
              message = "No account found with this email for password reset.";
              break;
            case "auth/invalid-email":
              message = "Please enter a valid email address.";
              break;
            default:
              console.error("Firebase password reset error:", error); // Log the full error
              message = "Error sending password reset email: " + error.message;
          }
          showMessage(message, "error");
        });
    });
  </script>

</body>
</html>
